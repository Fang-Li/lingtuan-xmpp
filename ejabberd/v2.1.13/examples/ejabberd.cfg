%% loglevel: Verbosity of log files generated by ejabberd.
%% 0: No ejabberd log at all (not recommended)
%% 1: Critical
%% 2: Error
%% 3: Warning
%% 4: Info
%% 5: Debug
%%
{loglevel, 5}.

{hosts, ["test.com"]}.

{host_config, "test.com", [ {http_server, "http://123.178.27.74/pet-hub" } , {auth_enable,false} ]}.

{listen,
 [

  {5222, ejabberd_c2s, [
			{certfile, "/etc/ejabberd/server.pem"}, starttls,
			{access, c2s},
			{shaper, c2s_shaper},
			{max_stanza_size, 65536}
		       ]},

  {5269, ejabberd_s2s_in, [
			   {shaper, s2s_shaper},
			   {max_stanza_size, 131072}
			  ]},

  {5280, ejabberd_http, [
                         {request_handlers, [
                               {["web"], mod_http_fileserver},
                               {["rest"], mod_rest}                          
			 ]},    
			 %%captcha,
			 http_bind,
			 http_poll,
			 %%register,
			 web_admin
			]}
 ]}.

{s2s_certfile, "/etc/ejabberd/server.pem"}.

{auth_method, external}. 

{shaper, normal, {maxrate, 3000000}}.

{shaper, fast, {maxrate, 5000000}}.

{max_fsm_queue, 100000}.

{acl, local, {user_regexp, ""}}.

{access, max_user_sessions, [{5, all}]}.

{access, max_user_offline_messages, [{100, admin}, {6000, all}]}.

{access, local, [{allow, local}]}.

{access, c2s, [{deny, blocked}, {allow, all}]}.

{access, c2s_shaper, [{none, admin}, {normal, all}]}.

{access, s2s_shaper, [{fast, all}]}.

{access, announce, [{allow, admin}]}.

{access, configure, [{allow, admin}]}.

{access, muc_admin, [{allow, admin}]}.

{access, muc_create, [{allow, all}]}.

{access, muc, [{allow, all}]}.

{access, pubsub_createnode, [{allow, all}]}.

{access, register, [{allow, all}]}.

{registration_timeout, infinity}.

{language, "en"}.

{modules,
 [
  {mod_adhoc,    []},
  {mod_announce, [{access, announce}]}, % recommends mod_adhoc
  {mod_blocking,[]}, % requires mod_privacy
  {mod_caps,     []},
  {mod_configure,[]}, % requires mod_adhoc
  {mod_disco,    []},
  %%{mod_echo,   [{host, "echo.localhost"}]},
  {mod_irc,      []},
  {mod_http_bind, []},
  %%{mod_http_fileserver, [
  %%                       {docroot, "/var/www"},
  %%                       {accesslog, "/var/log/ejabberd/access.log"}
  %%                      ]},
  {mod_last,     []},
  {mod_muc,      [
		  %%{host, "conference.@HOST@"},
		  {host, "conference.liangc.com"},
		  {access, muc},
		  {access_create, muc_create},
		  {access_persistent, muc_create},
		  {access_admin, muc_admin}
		 ]},
  %%{mod_muc_log,[]},
  {mod_offline,  [{access_max_user_messages, max_user_offline_messages}]},
  %%{mod_ping,  [{send_pings, true}, {ping_interval, 30}, {timeout_action, none}]},
  {mod_ping,  []},
  %%{mod_pres_counter,[{count, 5}, {interval, 60}]},
  {mod_privacy,  []},
  {mod_private,  []},
  %%{mod_proxy65,[]},
  {mod_pubsub,   [
		  {access_createnode, pubsub_createnode},
		  {ignore_pep_from_offline, true}, 
		  {last_item_cache, true}
		  %%,{plugins, ["flat", "hometree", "pep"]}  % pep requires mod_caps
		 ]},
  {mod_register, []},
  %%{mod_register_web, [
		  %%
		  %% When a user registers, send a notification to
		  %% these XMPP accounts.
		  %%
		  %%{registration_watchers, ["admin1@example.org"]}
  %%		 ]},
  {mod_roster,   []},
  %%{mod_service_log,[]},
  {mod_shared_roster,[]},
  {mod_stats,    []},
  {mod_time,     []},
  {mod_vcard,    []},
  {mod_version,  []},
  {mod_rest, [
            	 {allowed_ips, "all"},
              	 {allowed_stanza_types, [ "message", "presence", "iq" ]},
              	 {access_commands, [ {configure, [registered_users], []} ]} ]}
 ]}.

